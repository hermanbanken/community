
{{#with bill}}
<form role="form" method="post" action="/bills/{{#if _id}}{{_id}}{{/if}}">
<div class="container">
  <div class="row">
  	<div class="col-md-3">
      <h2 style="margin-bottom: .5cm">
        {{#if _id}}Edit bill{{else}}Create bill{{/if}}
        <button type="submit" class="btn btn-xs btn-default">{{t 'Save'}}</button>
        {{#if _id}}
        <input type="hidden" name="_id" value="{{_id}}" /> 
        <a data-action='remove' class="btn btn-xs btn-danger">{{t 'Delete'}}</a>
        {{else}}
        <a href='javascript:history.back()' class="btn btn-danger btn-xs">{{t 'Cancel'}}</a>
        {{/if}}
      </h2>
  	  <div class="form-group">
        <label for="date">{{t 'Name'}}</label>
        <input name="title" id="title" class="form-control" value="{{title}}" placeholder="{{t 'Bill name'}}" required />
      </div>
      <div class="form-group">
        <label for="date">{{t 'Date'}}</label>
        <input name="date" type="date" class="form-control" id="date" placeholder="Datum" value="{{datef date 'YYYY-MM-DD'}}" />
      </div>
      <div class="form-group">
        <label for="note">{{t 'Note'}}</label>
        <textarea id="note" class="form-control" name="note" rows="3">{{note}}</textarea>
      </div>
        
    </div>
    <!-- Bill editor -->
    <div class="col-md-9" style="padding-top: 0.5cm">

      {{#each ../users}}
      <input data-type="change" type="hidden" name="changes[{{_id}}]" value="{{lookup ../changes _id}}" />
      {{/each}}
      {{#each ../accounts}}
      <input data-type="cost" type="hidden" name="balances[{{_id}}]" value="{{lookup ../balances _id}}" />
      {{/each}}

      <!-- Nav tabs -->
      <ul class="nav nav-tabs" role="tablist">
        <li class="disabled"><a>{{t 'Choose Entry'}}:</a></li>
        {{#each ../billTypes}}
        <li {{#isEqual this to=../type}}class="active"{{/isEqual}}>
          <a href="#{{this}}" role="tab" data-toggle="tab">{{t this}}</a>
        </li>
        {{/each}}
      </ul>
      <!-- Tab panes -->
      <div class="tab-content" id="bill-type-tabs">
        <div class="tab-pane active" id="standard">

          <div class="table-wrap" style="margin-top:1em">
            <table class="table table-striped table-hover table-condensed table-bordered">
                <thead><tr>
                  {{#each ../accounts}}
                  <th>&Delta; {{this.name}}</th>
                  {{/each}}
                </tr></thead>
                <tr>
                  {{#each ../accounts}}
                  <td class="euro" data-account="{{_id}}">
                    <input data-type="cost-visual" class="seamless euro" type="number" step="0.01" value="{{currency (changeFor .. _id)}}" />
                  </td>
                  {{/each}}
                </tr>
            </table>
          </div>

          <div class="table-wrap" style="margin-top:1em">
            <table class="table table-striped table-hover table-condensed table-bordered">
                <thead><tr>
                  <th>{{t 'User'}}</th>
                  <th style="width:100px">{{t 'Aanwezig'}}</th>
                  <th style="width:100px">{{t 'Persoonlijk'}}</th>
                  <th style="width:100px">&Delta; {{t 'Saldo'}}</th>
                </tr></thead>
                {{#each ../users}}
                <tr data-type="user" data-user="{{_id}}">
                  <td class="truncate">
                    {{name profile}}
                    <input data-type="personal" type="hidden" name="personal[{{_id}}]" value="{{lookup ../personal _id}}"  />
                  </td>
                  <td>
                    <input data-type="presence" class="seamless" type="number" step="0.5"
                    name="presence[{{_id}}]" value="{{lookup ../presence _id}}" />
                  </td>
                  <td class="euro">
                    <input data-type="personal-visual" class="seamless euro" type="number"
                    value="{{currency (lookup ../personal _id)}}" step="0.01" />
                  </td>
                  <td class="euro">
                    <input data-type="change-visual" class="seamless euro" type="number" disabled="true" value="{{currency (lookup ../changes _id)}}" />
                  </td>
                </tr>
                {{/each}}
                <tfoot><tr>
                  <th class="truncate">Totalen</th>
                  <td data-type="total-presence"></td>
                  <td data-type="total-personal" class="euro"></td>
                  <td data-type="total-changes" class="euro"></td>
                </tr></foot>
            </table>
          </div>
        </div>
        <div class="tab-pane" id="deposit">1 persoon</div>
        <div class="tab-pane" id="activity">multi invoer</div>
      </div>

      <hr />

      <!--<ul class='accounts'>
      Difficiency coming from account:
      {{#each ../accounts}}
        <li class='money-entry'>
          Account - {{name}}
          <input type="number" step="0.01" name="account[{{name}}]" value="" />
      Difficiency comes from account:
      {{#each ../accounts}}
        <li class='money-entry'>
          Account - {{this.name}}
          <input type="number" step="0.01" name="balances[{{_id}}]" value="{{changeFor .. _id}}" />
        </li>
      {{/each}}

      Changes per user:
      {{#each ../users}}
        <li class='money-entry'>
          User - {{name profile}}
          <input type="number" step="0.01" name="changes[{{_id}}]" value="{{changeFor .. _id}}" />
        </li>
      {{/each}}
      </ul>-->
    </div>
  </div>
</div>
</form>
{{/with}}